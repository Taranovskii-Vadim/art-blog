---
import MainLayout from "../layouts/main.astro";
---

<MainLayout title="Intro">
  <div
    class="relative mx-12 flex flex-col items-center justify-center xl:flex-row xl:gap-36"
  >
    <div class="w-full xl:w-1/2">
      <h1 class="text-xl">
        This is title of my <span class="font-bold">blog</span>
      </h1>
      <div class="relative">
        <svg class="absolute h-full w-full overflow-visible">
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style={{ stopColor: "#DC3A2B", stopOpacity: 1 }}
              ></stop>
              <stop
                offset="100%"
                style={{ stopColor: "#E18510", stopOpacity: 1 }}></stop>
            </linearGradient>
          </defs>
          <path
            id="border-path"
            fill="none"
            stroke="url(#gradient)"
            stroke-width="4"></path>
        </svg>
        <p id="anim-p" class="p-6 text-lg">
          Lorem ipsum dolor sit amet consectetur adipisicing elit.
          <br />
          <br />
           Repellendus explicabo voluptatibus consequuntur blanditiis dolorum
          ducimus, voluptas reiciendis animi tenetur eligendi doloremque vitae
          necessitatibus molestiae cum distinctio asperiores?
          <br />
          <br />
           Quas, reiciendis quae.
        </p>
      </div>
      <div class="flex justify-center pt-12 text-center mb-12 xl:gap-16">
        <div class="w-32">
          <h2>Art posts</h2>
          <p id="art-counter" class="text-xl font-bold">85</p>
        </div>
        <div class="w-32">
          <h2>Youtube</h2>
          <p id="youtube-counter" class="text-xl font-bold">1.2m</p>
        </div>
        <div class="w-32">
          <h2>Reviews</h2>
          <p id="reviews-counter" class="text-xl font-bold">50</p>
        </div>
      </div>
    </div>
    <div class="relative">
      <img class="h-full" src="/portrait.jpg" alt="portrait" />
      <div class="absolute bottom-0 right-0 translate-y-1/4">
        <img src="/paint.svg" alt="paint" />
      </div>
    </div>
  </div>
</MainLayout>

<style>
  #border-path {
    animation: draw 1s forwards 1s ease-out;
  }

  @keyframes draw {
    to {
      stroke-dashoffset: 0;
    }
  }
</style>

<script>
  function updatePath() {
    const textMain = document.querySelector("#anim-p") as HTMLElement;
    const path = document.querySelector("#border-path") as SVGPathElement;

    if (textMain && path) {
      path.setAttribute(
        "d",
        `M0,0 V${textMain.offsetHeight} H${textMain.offsetWidth} v${
          textMain.offsetHeight / 2
        }`
      );
    }

    const pathLength = path.getTotalLength();
    path.style.strokeDasharray = pathLength.toString();
    path.style.strokeDashoffset = pathLength.toString();
  }

  function incrementCounter(
    selector: string,
    current: number,
    target: number,
    duration: number,
    letter = ""
  ) {
    const counter = document.getElementById(selector);
    const stepTime = Math.abs(Math.floor(duration / target));

    if (current < target && counter) {
      current++;
      counter.innerText = current.toString() + letter;

      setTimeout(
        () => incrementCounter(selector, current, target, duration, letter),
        stepTime
      );
    }
  }

  incrementCounter("art-counter", 0, 85, 2000);
  incrementCounter("youtube-counter", 0, 320, 1000, "k");
  incrementCounter("reviews-counter", 0, 250, 1000);

  window.addEventListener("DOMContentLoaded", updatePath);
  window.addEventListener("resize", updatePath);
</script>
